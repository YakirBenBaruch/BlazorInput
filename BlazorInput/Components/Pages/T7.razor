@page "/t7"

<h2 style="text-align:center; margin: 12px 0 18px 0;">נחש את המספר</h2>

<br />
<br />

<div style="
    width: 420px;
    margin: 0 auto;
    padding: 16px;
    border-radius: 18px;
    background: #f6f7fb;
    box-shadow: 0 10px 30px rgba(0,0,0,0.12);
    direction: rtl;">

    <div style="
        padding: 12px 14px;
        border-radius: 14px;
        background: #ffffff;
        border: 1px solid #d8dbe6;
        box-shadow: inset 0 2px 6px rgba(0,0,0,0.05);">

        <div style="font-weight:900; margin-bottom:8px;">
            נחש מספר בין 0 ל־10:
        </div>

        <input type="number" @bind="guess" min="0" max="10"
               style="
                    width: 100%;
                    height: 44px;
                    border-radius: 12px;
                    border: 1px solid #d8dbe6;
                    padding: 0 12px;
                    font-size: 16px;
                    font-weight: 800;
                    background: #ffffff;
                    outline: none;" />
    </div>

    <br />

    <div style="
        display:flex;
        justify-content: space-between;
        align-items:center;
        gap: 10px;">

        <button @onclick="checkGuess" disabled="@gameOver"
                style="
                    flex: 1;
                    height: 46px;
                    border-radius: 14px;
                    border: 1px solid #1f2a44;
                    background: #1f2a44;
                    color: white;
                    font-size: 16px;
                    font-weight: 900;
                    cursor: pointer;
                    box-shadow: 0 10px 22px rgba(0,0,0,0.12);
                    user-select: none;">
            נחש
        </button>

        <button @onclick="newGame"
                style="
                    flex: 1;
                    height: 46px;
                    border-radius: 14px;
                    border: 1px solid #d8dbe6;
                    background: #ffffff;
                    color: #111827;
                    font-size: 16px;
                    font-weight: 900;
                    cursor: pointer;
                    box-shadow: 0 10px 22px rgba(0,0,0,0.08);
                    user-select: none;">
            משחק חדש
        </button>
    </div>

    <br />
    <br />

    <div style="
        display:flex;
        justify-content: space-between;
        align-items:center;
        padding: 12px 14px;
        border-radius: 14px;
        background: #ffffff;
        border: 1px solid #d8dbe6;
        box-shadow: inset 0 2px 6px rgba(0,0,0,0.05);
        font-weight: 900;">
        <span>נסיונות שנותרו:</span>
        <span>@triesLeft</span>
    </div>

    <br />

    @if (message != "")
    {
        <div style="
                padding: 12px 14px;
                border-radius: 14px;
                background: #ffffff;
                border: 1px solid #d8dbe6;
                box-shadow: 0 10px 22px rgba(0,0,0,0.08);
                font-weight: 900;">
            @message
        </div>
    }
</div>

@code
{
    Random rnd = new Random();

    int secretNumber;
    int guess = 0;
    int triesLeft = 10;
    bool gameOver = false;
    string message = "";

    protected override void OnInitialized()
    {
        newGame();
    }

    void newGame()
    {
        secretNumber = rnd.Next(0, 11);
        triesLeft = 10;
        guess = 0;
        gameOver = false;
        message = "";
    }

    void checkGuess()
    {
        if (gameOver)
        {
            return;
        }

        triesLeft--;

        if (guess == secretNumber)
        {
            message = "ניחשת נכון!";
            gameOver = true;
        }
        else if (triesLeft == 0)
        {
            message = "GAME OVER";
            gameOver = true;
        }
        else if (guess < secretNumber)
        {
            message = "המספר קטן מדי";
        }
        else
        {
            message = "המספר גדול מדי";
        }
    }
}
